<app-header></app-header>

<!-- Loading State -->
<section class="shop-details" *ngIf="isLoading">
    <div class="container">
        <div style="text-align: center; padding: 120px 20px;">
            <div style="display: inline-block; width: 60px; height: 60px; border: 5px solid #f3f3f3; border-top: 5px solid #ca1515; border-radius: 50%; animation: spin 1s linear infinite;"></div>
            <p style="margin-top: 20px; color: #666; font-size: 16px;">Loading product details...</p>
        </div>
    </div>
</section>

<!-- Product Not Found -->
<section class="shop-details" *ngIf="!isLoading && productNotFound">
    <div class="container">
        <div style="text-align: center; padding: 120px 20px;">
            <i class="fa fa-exclamation-circle" style="font-size: 100px; color: #ddd; margin-bottom: 25px;"></i>
            <h2 style="color: #666; margin-bottom: 15px;">Product Not Found</h2>
            <p style="color: #999; margin-bottom: 30px; font-size: 16px;">Sorry, the product you're looking for doesn't exist or has been removed.</p>
            <a routerLink="/shop" 
               style="background: #ca1515; color: white; border: none; padding: 14px 35px; cursor: pointer; border-radius: 4px; font-size: 14px; font-weight: 600; text-decoration: none; display: inline-block;">
                Back to Shop
            </a>
        </div>
    </div>
</section>

<!-- Shop Details Section Begin -->
<section class="shop-details" *ngIf="!isLoading && !productNotFound && product">
    <div class="product__details__pic">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="product__details__breadcrumb">
                        <a routerLink="/">Home</a>
                        <a routerLink="/shop">Shop</a>
                        <span>{{ product?.name || 'Product Details' }}</span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 col-md-3">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item" *ngFor="let img of product?.images || []; let i = index">
                            <a class="nav-link" 
                               [class.active]="i === 0"
                               [attr.data-toggle]="'tab'" 
                               [attr.href]="'#tabs-' + (i + 1)" 
                               role="tab">
                                <div class="product__thumb__pic set-bg" 
                                     [style.background-image]="'url(' + img + ')'"
                                     [style.background-size]="'cover'"
                                     [style.background-position]="'center center'"
                                     [style.background-repeat]="'no-repeat'">
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-6 col-md-9">
                    <div class="tab-content">
                        <div *ngFor="let img of product?.images || []; let i = index" 
                             class="tab-pane" 
                             [class.active]="i === 0"
                             [id]="'tabs-' + (i + 1)" 
                             role="tabpanel">
                            <div class="product__details__pic__item">
                                <img [src]="img" [alt]="product?.name">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="product__details__content">
        <div class="container">
            <div class="row d-flex justify-content-center">
                <div class="col-lg-8">
                    <div class="product__details__text">
                        <h4>{{ product?.name || 'Loading...' }}</h4>
                        <!-- <div class="rating">
                            <i *ngFor="let star of getStarArray(product?.rating || 0)" 
                               class="fa"
                               [ngClass]="star <= (product?.rating || 0) ? 'fa-star' : 'fa-star-o'">
                            </i>
                            <span> - {{ product?.reviewCount || 0 }} Reviews</span>
                        </div> -->
                        <h3>${{ product ? product.price.toFixed(2) : '0.00' }} <span *ngIf="product?.sale">${{ product?.originalPrice?.toFixed(2) }}</span></h3>
                        <p>{{ product?.description || 'Loading product details...' }}</p>
                        <div class="product__details__option">
                            <div class="product__details__option__size">
                                <span>Size:</span>
                                <label *ngFor="let size of product?.sizes || []; let i = index" [class.active]="i === 0" [attr.for]="'size-' + i">
                                    {{ size }}
                                    <input type="radio" [id]="'size-' + i">
                                </label>
                            </div>
                            <!--
                            <div class="product__details__option__color">
                                <span>Color:</span>
                                <label class="c-1" for="sp-1">
                                    <input type="radio" id="sp-1">
                                </label>
                                <label class="c-2" for="sp-2">
                                    <input type="radio" id="sp-2">
                                </label>
                                <label class="c-3" for="sp-3">
                                    <input type="radio" id="sp-3">
                                </label>
                                <label class="c-4" for="sp-4">
                                    <input type="radio" id="sp-4">
                                </label>
                                <label class="c-9" for="sp-9">
                                    <input type="radio" id="sp-9">
                                </label>
                            </div>
                            -->
                        </div>
                        <!--
                        <div class="product__details__cart__option">
                            <div class="quantity">
                                <div class="pro-qty">
                                    <input type="text" value="1">
                                </div>
                            </div>
                            <a href="#" class="primary-btn">add to cart</a>
                        </div>
                        -->
                        <!-- <div class="product__details__btns__option">
                            <a href="#"><i class="fa fa-heart"></i> add to wishlist</a>
                            <a href="#"><i class="fa fa-exchange"></i> Add To Compare</a>
                        </div> -->
                        <!--
                        <div class="product__details__last__option">
                            <h5><span>Guaranteed Safe Checkout</span></h5>
                            <img src="assets/theme/img/shop-details/details-payment.png" alt="">
                            <ul>
                                <li><span>SKU:</span> 3812912</li>
                                <li><span>Categories:</span> Clothes</li>
                                <li><span>Tag:</span> Clothes, Skin, Body</li>
                            </ul>
                        </div>
                        -->
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="product__details__tab">
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#tabs-5"
                                role="tab">Description</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#tabs-6" role="tab">Product Info</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#tabs-7" role="tab">Material</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabs-5" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <p class="note">{{ product?.shortDescription || product?.description }}</p>
                                    <div class="product__details__tab__content__item">
                                        <h5>Description</h5>
                                        <p>{{ product?.description }}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabs-6" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <div class="product__details__tab__content__item">
                                        <h5>Product Information</h5>
                                        <p>{{ product?.detailedDescription?.productsInfo || product?.additionalInfo }}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabs-7" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <div class="product__details__tab__content__item">
                                        <h5>Material Used</h5>
                                        <p>{{ product?.detailedDescription?.materialUsed || product?.material }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shop Details Section End -->

<!-- Related Section Begin -->
<section class="related spad" *ngIf="!isLoading && relatedProducts && relatedProducts.length > 0">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h3 class="related-title">Related Product</h3>
            </div>
        </div>
        <div class="row">
            <div *ngFor="let relatedProduct of relatedProducts" class="col-lg-3 col-md-6 col-sm-6">
                <div class="product__item" [class.sale]="relatedProduct.sale">
                    <div class="product__item__pic" 
                         [style.background-image]="'url(' + relatedProduct.thumbnail + ')'"
                         [style.background-size]="'cover'"
                         [style.background-position]="'center center'"
                         [style.background-repeat]="'no-repeat'">
                        <span *ngIf="relatedProduct.sale" class="label">Sale</span>
                        <span *ngIf="relatedProduct.newArrival && !relatedProduct.sale" class="label">New</span>
                        <ul class="product__hover">
                            <!-- <li><a href="#"><i class="icon_heart_alt"></i></a></li>
                            <li><a href="#"><i class="icon_refresh"></i> <span>Compare</span></a></li> -->
                            <!-- <li><a href="#"><i class="icon_search"></i></a></li> -->
                            <li><a [routerLink]="['/shop-details', relatedProduct.uuid]"><i class="icon_info_alt"></i> <span>Detail</span></a></li>
                        </ul>
                    </div>
                    <div class="product__item__text">
                        <h6>
                            <a [routerLink]="['/shop-details', relatedProduct.uuid]">{{ relatedProduct.name }}</a>
                        </h6>
                        <!-- <a class="add-cart" style="cursor: pointer;">+ Add To Cart</a> -->
                        <div class="rating">
                            <i *ngFor="let star of getStarArray(relatedProduct.rating)" 
                               class="fa"
                               [ngClass]="star <= relatedProduct.rating ? 'fa-star' : 'fa-star-o'">
                            </i>
                        </div>
                        <h5>
                            ${{ relatedProduct.price.toFixed(2) }}
                            <span *ngIf="relatedProduct.sale" style="text-decoration: line-through; color: #999; margin-left: 10px;">
                                ${{ relatedProduct.originalPrice.toFixed(2) }}
                            </span>
                        </h5>
                        <div class="product__color__select">
                            <label *ngFor="let colorId of relatedProduct.colors.slice(0, 3); let i = index" 
                                   [for]="'rpc-' + relatedProduct.id + '-' + i">
                                <input type="radio" [id]="'rpc-' + relatedProduct.id + '-' + i" [name]="'rp-color-' + relatedProduct.id">
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Related Section End -->

<app-footer></app-footer>
