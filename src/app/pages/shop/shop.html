<app-header></app-header>

<!-- Breadcrumb Section Begin -->
<section class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__text">
                    <h4>Shop</h4>
                    <div class="breadcrumb__links">
                        <a routerLink="/">Home</a>
                        <span>Shop</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Breadcrumb Section End -->

<!-- Shop Section Begin -->
<section class="shop spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="shop__sidebar">
                    <div class="shop__sidebar__search">
                        <form (submit)="onSearch(); $event.preventDefault()">
                            <input type="text" placeholder="Search..." [(ngModel)]="searchTerm" name="search">
                            <button type="submit"><span class="icon_search"></span></button>
                        </form>
                    </div>
                    <!-- Reset All Filters Button -->
                    <div style="padding: 15px 0;">
                        <button (click)="resetAllFilters()" 
                                style="width: 100%; padding: 10px; background: #ca1515; color: white; border: none; cursor: pointer; border-radius: 4px; font-weight: 600;">
                            Reset All Filters
                        </button>
                    </div>
                    <div class="shop__sidebar__accordion">
                        <div class="accordion" id="accordionExample">
                            <!-- Categories -->
                            <div class="card">
                                <div class="card-heading">
                                    <a data-toggle="collapse" data-target="#collapseOne">Categories</a>
                                </div>
                                <div id="collapseOne" class="collapse show" data-parent="#accordionExample">
                                    <div class="card-body">
                                        <div class="shop__sidebar__categories">
                                            <ul class="nice-scroll">
                                                <li *ngFor="let category of productData?.categories">
                                                    <a (click)="toggleCategory(category.id)" 
                                                       [class.active]="isCategorySelected(category.id)"
                                                       style="cursor: pointer;">
                                                        {{ category.name }} ({{ category.count }})
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Brands -->
                            <div class="card">
                                <div class="card-heading">
                                    <a data-toggle="collapse" data-target="#collapseTwo">Branding</a>
                                </div>
                                <div id="collapseTwo" class="collapse show" data-parent="#accordionExample">
                                    <div class="card-body">
                                        <div class="shop__sidebar__brand">
                                            <ul>
                                                <li *ngFor="let brand of productData?.brands">
                                                    <a (click)="toggleBrand(brand.id)"
                                                       [class.active]="isBrandSelected(brand.id)"
                                                       style="cursor: pointer;">
                                                        {{ brand.name }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Price Ranges -->
                            <div class="card">
                                <div class="card-heading">
                                    <a data-toggle="collapse" data-target="#collapseThree">Filter Price</a>
                                </div>
                                <div id="collapseThree" class="collapse show" data-parent="#accordionExample">
                                    <div class="card-body">
                                        <div class="shop__sidebar__price">
                                            <ul>
                                                <li *ngFor="let range of productData?.priceRanges">
                                                    <a (click)="setPriceRange(range)"
                                                       [class.active]="isPriceRangeSelected(range)"
                                                       style="cursor: pointer;">
                                                        {{ range.label }}
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Sizes -->
                            <div class="card">
                                <div class="card-heading">
                                    <a data-toggle="collapse" data-target="#collapseFour">Size</a>
                                </div>
                                <div id="collapseFour" class="collapse show" data-parent="#accordionExample">
                                    <div class="card-body">
                                        <div class="shop__sidebar__size">
                                            <label *ngFor="let size of productData?.sizes" 
                                                   [for]="'size-' + size"
                                                   [class.active]="isSizeSelected(size)">
                                                {{ size }}
                                                <input type="checkbox" 
                                                       [id]="'size-' + size"
                                                       [checked]="isSizeSelected(size)"
                                                       (change)="toggleSize(size)">
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Colors - COMMENTED OUT -->
                            <!--
                            <div class="card">
                                <div class="card-heading">
                                    <a data-toggle="collapse" data-target="#collapseFive">Colors</a>
                                </div>
                                <div id="collapseFive" class="collapse show" data-parent="#accordionExample">
                                    <div class="card-body">
                                        <div class="shop__sidebar__color">
                                            <label *ngFor="let color of productData?.colors" 
                                                   [class]="color.class"
                                                   [class.active]="isColorSelected(color.id)"
                                                   [for]="'color-filter-' + color.id"
                                                   [title]="color.name">
                                                <input type="checkbox" 
                                                       [id]="'color-filter-' + color.id"
                                                       [checked]="isColorSelected(color.id)"
                                                       (change)="toggleColor(color.id)">
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            -->
                            <!-- Tags -->
                            <div class="card">
                                <div class="card-heading">
                                    <a data-toggle="collapse" data-target="#collapseSix">Tags</a>
                                </div>
                                <div id="collapseSix" class="collapse show" data-parent="#accordionExample">
                                    <div class="card-body">
                                        <div class="shop__sidebar__tags">
                                            <a *ngFor="let tag of productData?.tags" 
                                               (click)="toggleTag(tag)"
                                               [class.active]="isTagSelected(tag)"
                                               style="cursor: pointer;">
                                                {{ tag }}
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-9">
                <div class="shop__product__option">
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <div class="shop__product__option__left">
                                <p>Showing {{ (currentPage - 1) * itemsPerPage + 1 }}â€“{{ Math.min(currentPage * itemsPerPage, totalResults) }} of {{ totalResults }} results</p>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <div class="shop__product__option__right">
                                <p>Sort by:</p>
                                <select (change)="onSortChange($event)">
                                    <option value="price-asc" [selected]="sortBy === 'price-asc'">Price: Low To High</option>
                                    <option value="price-desc" [selected]="sortBy === 'price-desc'">Price: High To Low</option>
                                    <option value="name-asc" [selected]="sortBy === 'name-asc'">Name: A to Z</option>
                                    <option value="name-desc" [selected]="sortBy === 'name-desc'">Name: Z to A</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Loading State -->
                <div class="row" *ngIf="isLoading">
                    <div class="col-lg-12">
                        <div style="text-align: center; padding: 80px 20px;">
                            <div style="display: inline-block; width: 60px; height: 60px; border: 5px solid #f3f3f3; border-top: 5px solid #ca1515; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                            <p style="margin-top: 20px; color: #666; font-size: 16px;">Loading products...</p>
                        </div>
                    </div>
                </div>

                <!-- No Products Found -->
                <div class="row" *ngIf="!isLoading && dataLoaded && displayedProducts.length === 0">
                    <div class="col-lg-12">
                        <div style="text-align: center; padding: 80px 20px;">
                            <i class="fa fa-shopping-bag" style="font-size: 80px; color: #ddd; margin-bottom: 20px;"></i>
                            <h3 style="color: #666; margin-bottom: 15px;">No Products Found</h3>
                            <p style="color: #999; margin-bottom: 25px;">We couldn't find any products matching your criteria.</p>
                            <button (click)="resetAllFilters()" 
                                    style="background: #ca1515; color: white; border: none; padding: 12px 30px; cursor: pointer; border-radius: 4px; font-size: 14px; font-weight: 600;">
                                Reset All Filters
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Products Grid -->
                <div class="row" *ngIf="!isLoading && displayedProducts.length > 0">
                    <div *ngFor="let product of displayedProducts" class="col-lg-4 col-md-6 col-sm-6">
                        <div class="product__item" [class.sale]="product.sale">
                            <div class="product__item__pic" 
                                 [style.background-image]="'url(' + product.thumbnail + ')'"
                                 [style.background-size]="'cover'"
                                 [style.background-position]="'center center'"
                                 [style.background-repeat]="'no-repeat'"
                                 [style.min-height]="'350px'">
                                <span *ngIf="product.sale" class="label">Sale</span>
                                <ul class="product__hover">
                                    <!-- <li><a href="#"><i class="icon_heart_alt"></i></a></li>
                                    <li><a href="#"><i class="icon_refresh"></i> <span>Compare</span></a></li> -->
                                    <!-- <li><a href="#"><i class="icon_search"></i></a></li> -->
                                    <li><a [routerLink]="['/shop-details', product.uuid]"><i class="icon_info_alt"></i> <span>Detail</span></a></li>
                                </ul>
                            </div>
                            <div class="product__item__text">
                                <h6>
                                    <a [routerLink]="['/shop-details', product.uuid]">{{ product.name }}</a>
                                </h6>
                                <!-- <a (click)="addToCart(product, $event)" class="add-cart" style="cursor: pointer;">+ Add To Cart</a> -->
                                <!-- <div class="rating">
                                    <i *ngFor="let star of getStarArray(product.rating)" 
                                       class="fa"
                                       [ngClass]="star <= product.rating ? 'fa-star' : 'fa-star-o'">
                                    </i>
                                </div> -->
                                <h5>
                                    ${{ product.price.toFixed(2) }}
                                    <span *ngIf="product.sale" style="text-decoration: line-through; color: #999; margin-left: 10px;">
                                        ${{ product.originalPrice.toFixed(2) }}
                                    </span>
                                </h5>
                                <!-- <div class="product__color__select">
                                    <label *ngFor="let colorId of product.colors.slice(0, 3); let i = index" 
                                           [class]="getColorById(colorId)?.class || ''"
                                           [class.active]="i === 0"
                                           [for]="'pc-' + product.id + '-' + i">
                                        <input type="radio" [id]="'pc-' + product.id + '-' + i" [name]="'color-' + product.id">
                                    </label>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Pagination -->
                <div class="row" *ngIf="!isLoading && totalPages > 1">
                    <div class="col-lg-12">
                        <div class="product__pagination">
                            <a *ngIf="currentPage > 1" 
                               (click)="previousPage()" 
                               style="cursor: pointer;">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a *ngFor="let page of getPaginationArray()" 
                               (click)="goToPage(page)"
                               [class.active]="currentPage === page"
                               style="cursor: pointer;">
                                {{ page }}
                            </a>
                            <a *ngIf="currentPage < totalPages" 
                               (click)="nextPage()"
                               style="cursor: pointer;">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shop Section End -->

<app-footer></app-footer>
